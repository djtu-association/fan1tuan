<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>

	<constant name="struts.dev" value="true"></constant>
	<constant name="struts.action.extension" value="f1t" />

	<package name="main" extends="struts-default" namespace="/">
		
		<result-types>
			<result-type name="jsonResult"
				class="com.fan1tuan.general.ui.struts2.result.JsonResult" />
		</result-types>
		
		<interceptors>
            <interceptor name="needLoginFilter" class="com.fan1tuan.general.ui.struts2.interceptor.NeedLoginInterceptor"/>
            
            <interceptor-stack name="fan1tuanStack">
                <interceptor-ref name="needLoginFilter"/>
                <interceptor-ref name="defaultStack"/>
            </interceptor-stack>
            
   		</interceptors>
   		<default-interceptor-ref name="fan1tuanStack"/>
   		
   		<!-- 前期开发不要弄default action ref，会找不出很多错误！！！！ -->
	    <!-- <default-action-ref name="notfound"></default-action-ref> -->
	    
	    <global-results>
	    	<result name="global_ajax_login" type="chain">
	    		<param name="actionName">ajaxNeedLogin</param>
       			<param name="namespace">/ajax</param>
	    	</result>
	    	<result name="global_page_login" type="chain">
	    		<param name="actionName">needLogin</param>
       			<param name="namespace">/</param>
	    	</result>
	    	
	    	<result name="error">
				/WEB-INF/ftls/500.html
	    	</result>
	    </global-results>
	    <action name="notfound">
	    	<result>/WEB-INF/ftls/404.html</result>
	    </action>
	   

		<action name="jsonTest" class="com.fan1tuan.general.ui.struts2.core.MainAction">
			<result name="success" type="jsonResult">
				<!-- <param name="included">projectName,shoppingCart</param> -->
				<!-- 省略<param />标签，直接填写希望以json返回的变量也是可以的 -->
				shoppingCart
			</result>
		</action>
		
		<action name="freemarkerIndex" class="com.fan1tuan.general.ui.struts2.core.MainAction">
			<result name="success" type="freemarker">/WEB-INF/ftls/index.ftl</result>
		</action>
		
		<action name="sitemeshHello" class="com.fan1tuan.general.ui.struts2.core.MainAction">
			<result name="success" type="freemarker">/WEB-INF/ftls/hello.ftl</result>
		</action>
		
		<action name="needLogin" method="needLogin" class="com.fan1tuan.general.ui.struts2.core.InnerAction">
		    <result>
		        <param name="actionName">signin.f1t</param>
       			<param name="namespace">/index</param>
       			<param name="redirect">${redirect}</param>
		    </result>
		</action>
		
	</package>

	<package name="main_ajax" namespace="/ajax" extends="main">
	    <action name="ajaxNeedLogin" method="needLogin" class="com.fan1tuan.general.ui.struts2.core.InnerAction">
	        <result type="jsonResult">flag,redirect</result>
	    </action>
	</package>

	<include file="com/fan1tuan/config/struts-index.xml"></include>
	<include file="com/fan1tuan/config/struts-order.xml"></include>
	<include file="com/fan1tuan/config/struts-rank.xml"></include>
	<include file="com/fan1tuan/config/struts-search.xml"></include>
	<include file="com/fan1tuan/config/struts-shop.xml"></include>
	<include file="com/fan1tuan/config/struts-user.xml"></include>
	<include file="com/fan1tuan/config/struts-life.xml"></include>
	

</struts>